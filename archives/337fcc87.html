<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="MySQL基础篇, 云卷舒">
    <meta name="description" content="一、SQL
全称 Structured Query Language，结构化查询语言。操作关系型数据库的编程语言，定义了一套操作关系型数据库统一标准 。


1.SQL通用语法
在学习具体的SQL语句之前，先来了解一下SQL语言的同于语法。">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>MySQL基础篇 | 云卷舒</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.2.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="云卷舒" type="application/atom+xml">
</head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">云卷舒</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">云卷舒</div>
        <div class="logo-desc">
            
            岁月不回头，且行且珍惜
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/9.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">MySQL基础篇</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/mysql/">
                                <span class="chip bg-color">mysql</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" class="post-category">
                                数据库
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2023-09-20
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="一、SQL"><a href="#一、SQL" class="headerlink" title="一、SQL"></a>一、SQL</h1><blockquote>
<p>全称 <code>Structured Query Language</code>，结构化查询语言。操作关系型数据库的编程语言，定义了一套操作关系型数据库统一<strong>标准</strong> 。</p>
<span id="more"></span>
</blockquote>
<h2 id="1-SQL通用语法"><a href="#1-SQL通用语法" class="headerlink" title="1.SQL通用语法"></a>1.SQL通用语法</h2><blockquote>
<p>在学习具体的SQL语句之前，先来了解一下SQL语言的同于语法。</p>
</blockquote>
<ol>
<li>SQL语句可以单行或多行书写，以分号结尾。</li>
<li>SQL语句可以使用空格/缩进来增强语句的可读性。</li>
<li>MySQL数据库的SQL语句<strong>不区分大小写</strong>，关键字建议使用大写。</li>
<li>注释：<ul>
<li>单行注释：<code>--</code> 注释内容 或 <code># </code>注释内容</li>
<li>多行注释：<code>/* 注释内容 */</code></li>
</ul>
</li>
</ol>
<h2 id="2-SQL分类"><a href="#2-SQL分类" class="headerlink" title="2.SQL分类"></a>2.SQL分类</h2><blockquote>
<p><strong>SQL语句，根据其功能，主要分为四类：<code>DDL</code>、<code>DML</code>、<code>DQL</code>、<code>DCL</code>。</strong></p>
<p><strong>但是作为<code>Java开发</code>的程序员我们仅需掌握<code>DML</code>及<code>DQL</code>即可。</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th align="left">分类</th>
<th align="left">全称</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>DDL</strong></td>
<td align="left">Data Definition Language</td>
<td align="left">数据定义语言，用来定义数据库对象（<strong>数据库、表、字段</strong>）</td>
</tr>
<tr>
<td align="left"><strong>DML</strong></td>
<td align="left">Data Manipulation Language</td>
<td align="left">数据操作语言，用来对数据库表中的数据进行<strong>增删改</strong></td>
</tr>
<tr>
<td align="left"><strong>DQL</strong></td>
<td align="left">Data Query Language</td>
<td align="left">数据查询语言，用来<strong>查询数据库中表的记录</strong></td>
</tr>
<tr>
<td align="left"><strong>DCL</strong></td>
<td align="left">Data Control Language</td>
<td align="left">数据控制语言，用来<strong>创建数据库用户</strong>、控制数据库的控制权限</td>
</tr>
</tbody></table>
<h2 id="3-DDL"><a href="#3-DDL" class="headerlink" title="3.DDL"></a>3.DDL</h2><blockquote>
<p><strong><code>Data Definition Language</code>，数据定义语言，用来定义数据库对象(数据库，表，字段) 。</strong></p>
</blockquote>
<h3 id="3-1-操作数据库的命令"><a href="#3-1-操作数据库的命令" class="headerlink" title="3.1 操作数据库的命令"></a>3.1 操作数据库的命令</h3><blockquote>
<p>下面演示的命令中出现的中括号表示为可选命令（加粗字体为常用命令）</p>
</blockquote>
<ol>
<li><p>查询所有数据库</p>
<pre class="line-numbers language-none"><code class="language-none">SHOW DATABASES;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询当前数据库</p>
<pre class="line-numbers language-none"><code class="language-none">SELECT DATABASE();
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p><strong>创建数据库</strong></p>
<pre class="line-numbers language-none"><code class="language-none"># UTF8字符集长度为3字节，有些符号占4字节，所以推荐用utf8mb4字符集
CREATE DATABASE [ IF NOT EXISTS ] 数据库名 [ DEFAULT CHARSET 字符集] [COLLATE 排序规则 ];
SQL<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p><strong>删除数据库</strong></p>
<pre class="line-numbers language-none"><code class="language-none">DROP DATABASE [ IF EXISTS ] 数据库名;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>使用数据库</p>
<pre class="line-numbers language-none"><code class="language-none">USE 数据库名;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ol>
<h3 id="3-2-操作表的命令"><a href="#3-2-操作表的命令" class="headerlink" title="3.2 操作表的命令"></a>3.2 操作表的命令</h3><blockquote>
<p>下面演示的命令中出现的中括号表示为可选命令（加粗字体为常用命令）</p>
</blockquote>
<ol>
<li><p>查询当前数据库所有表</p>
<pre class="line-numbers language-none"><code class="language-none">SHOW TABLES;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p><strong>查询表结构</strong></p>
<pre class="line-numbers language-none"><code class="language-none">DESC 表名;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p><strong>查询指定表的建表语句</strong></p>
<pre class="line-numbers language-none"><code class="language-none">SHOW CREATE TABLE 表名;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p><strong>创建表（注意：最后一个字段后面没有逗号）</strong></p>
<pre class="line-numbers language-none"><code class="language-none">create table 表名 (
字段名1 类型(宽度) 约束条件 [COMMENT 字段1注释],
字段名2 类型(宽度) 约束条件 [COMMENT 字段2注释],
字段名3 类型(宽度) 约束条件 [COMMENT 字段3注释]
) [ COMMENT 表注释 ];
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>添加字段</p>
<pre class="line-numbers language-none"><code class="language-none">ALTER TABLE 表名 ADD 字段名 类型(长度) [COMMENT 注释] [约束];
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>修改数据类型</p>
<pre class="line-numbers language-none"><code class="language-none">ALTER TABLE 表名 MODIFY 字段名 新数据类型(长度);
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>修改字段名和字段类型</p>
<pre class="line-numbers language-none"><code class="language-none">ALTER TABLE 表名 CHANGE 旧字段名 新字段名 类型(长度) [COMMENT 注释] [约束];
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>删除字段</p>
<pre class="line-numbers language-none"><code class="language-none">ALTER TABLE 表名 DROP 字段名;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>修改表名</p>
<pre class="line-numbers language-none"><code class="language-none">ALTER TABLE 表名 RENAME TO 新表名;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p><strong>删除表</strong></p>
<pre class="line-numbers language-none"><code class="language-none">#将整张表彻底删掉
DROP TABLE [IF EXISTS] 表名;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">#以该方式删除的表相当于仅删除表中的数据，但是表结构保留
TRUNCATE TABLE 表名;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
</ol>
<p><strong>Ps：实际开发中表的结构在创建时就已经确定了，后期基本上不会出现更改或者添加字段的情况，因此关于操作字段的命令可以不用死记。</strong></p>
<h3 id="3-3-字段的数据类型"><a href="#3-3-字段的数据类型" class="headerlink" title="3.3 字段的数据类型"></a>3.3 字段的数据类型</h3><h4 id="a）-整型"><a href="#a）-整型" class="headerlink" title="a） 整型"></a>a） 整型</h4><table>
<thead>
<tr>
<th align="left">MySQL数据类型</th>
<th align="left">含义（有符号）</th>
</tr>
</thead>
<tbody><tr>
<td align="left">tinyint</td>
<td align="left">1字节，范围（-128~127）</td>
</tr>
<tr>
<td align="left">smallint</td>
<td align="left">2字节，范围（-32768~32767）</td>
</tr>
<tr>
<td align="left">mediumint</td>
<td align="left">3字节，范围（-8388608~8388607）</td>
</tr>
<tr>
<td align="left">int</td>
<td align="left">4字节，范围（-2147483648~2147483647）</td>
</tr>
<tr>
<td align="left">bigint</td>
<td align="left">8字节，范围（±9.22*10的18次方）</td>
</tr>
</tbody></table>
<p>整型默认使用的都是有符号的，当然了，我们也可以加上<code>unsigned</code>关键字，定义成无符号的类型，那么对应的取值范围就会发生改变。</p>
<p>比如：<code>tinyint unsigned</code>的取值范围为<code>0~255</code>，</p>
<h4 id="b）-浮点型"><a href="#b）-浮点型" class="headerlink" title="b） 浮点型"></a>b） 浮点型</h4><table>
<thead>
<tr>
<th align="left">MySQL数据类型</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">float(m, d)</td>
<td align="left">4字节，单精度浮点型，m总长度，d小数位</td>
</tr>
<tr>
<td align="left">double(m, d)</td>
<td align="left">8字节，双精度浮点型，m总长度，d小数位</td>
</tr>
<tr>
<td align="left">decimal(m, d)</td>
<td align="left">decimal是存储为字符串的浮点数，对应我们java的Bigdecimal</td>
</tr>
</tbody></table>
<p>我们使用一个例子来判断小括号内参数的含义，针对数据类型为<code>float(5, 3)</code>的列，做了以下试验：</p>
<ul>
<li>插入<code>123.45678</code>，最后查询得到的结果为<code>99.999</code>；</li>
<li>插入<code>12.34567</code>，最后查询结果为<code>12.346</code>；</li>
</ul>
<p>所以，在使用浮点型的时候，还是要注意陷阱的，要以插入数据库中的实际结果为准。</p>
<h4 id="c）-字符串"><a href="#c）-字符串" class="headerlink" title="c） 字符串"></a>c） 字符串</h4><table>
<thead>
<tr>
<th align="left">MySQL数据类型</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">char(n)</td>
<td align="left">固定长度，最多255个字符</td>
</tr>
<tr>
<td align="left">varchar(n)</td>
<td align="left">可变长度，最大容量65535个字节</td>
</tr>
<tr>
<td align="left">tinytext</td>
<td align="left">可变长度，最大容量255个字节</td>
</tr>
<tr>
<td align="left">text</td>
<td align="left">可变长度，最大容量65535个字节</td>
</tr>
<tr>
<td align="left">mediumtext</td>
<td align="left">可变长度，最大容量2的24次方-1个字节 16MB</td>
</tr>
<tr>
<td align="left">longtext</td>
<td align="left">可变长度，最大容量2的32次方-1个字节 4GB</td>
</tr>
</tbody></table>
<h4 id="d）-日期和时间"><a href="#d）-日期和时间" class="headerlink" title="d） 日期和时间"></a>d） 日期和时间</h4><table>
<thead>
<tr>
<th align="left">MySQL数据类型</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>date</strong></td>
<td align="left">3字节，日期，格式：2022-09-18</td>
</tr>
<tr>
<td align="left"><strong>time</strong></td>
<td align="left">3字节，时间，格式：08:42:30</td>
</tr>
<tr>
<td align="left"><strong>datetime</strong></td>
<td align="left">8字节，日期时间，格式：2022-09-18 08:42:30</td>
</tr>
<tr>
<td align="left">timestamp</td>
<td align="left">4字节，自动存储记录修改的时间</td>
</tr>
<tr>
<td align="left">year</td>
<td align="left">1字节，年份，格式：2020</td>
</tr>
</tbody></table>
<h2 id="4-DML（常用）"><a href="#4-DML（常用）" class="headerlink" title="4.DML（常用）"></a>4.DML（常用）</h2><blockquote>
<p><strong>DML英文全称是Data Manipulation Language(数据操作语言)，用来对数据库中表的数据记录进行<code>增、删、改</code>操作。</strong></p>
</blockquote>
<ul>
<li>添加数据（<code>INSERT</code>）</li>
<li>修改数据（<code>UPDATE</code>）</li>
<li>删除数据（<code>DELETE</code>）</li>
</ul>
<h3 id="4-1-添加数据"><a href="#4-1-添加数据" class="headerlink" title="4.1 添加数据"></a>4.1 添加数据</h3><ol>
<li><p>添加指定字段</p>
<pre class="line-numbers language-none"><code class="language-none">INSERT INTO 表名 (字段名1, 字段名2, ...) VALUES (值1, 值2, ...);
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>添加全部字段</p>
<pre class="line-numbers language-none"><code class="language-none">INSERT INTO 表名 VALUES (值1, 值2, ...);
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>批量添加数据</p>
<pre class="line-numbers language-none"><code class="language-none">INSERT INTO 表名 (字段名1, 字段名2, ...) VALUES (值1, 值2, ...),(值1, 值2, ...), (值1, 值2, ...);
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">INSERT INTO 表名 VALUES (值1, 值2, ...), (值1, 值2, ...), (值1, 值2, ...);
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ol>
<p>注意事项</p>
<ul>
<li>插入数据时，指定的字段顺序需要与值的顺序是一一对应的。</li>
<li>字符串和日期类型数据应该包含在引号中</li>
<li>插入的数据大小应该在字段的规定范围内</li>
</ul>
<h3 id="4-2-修改和删除数据"><a href="#4-2-修改和删除数据" class="headerlink" title="4.2 修改和删除数据"></a>4.2 修改和删除数据</h3><ol>
<li><p>修改符合条件的数据</p>
<pre class="line-numbers language-none"><code class="language-none">UPDATE 表名 SET 字段名1 = 值1, 字段名2 = 值2, ... [ WHERE 条件 ];
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>删除复合条件的数据</p>
<pre class="line-numbers language-none"><code class="language-none">DELETE FROM 表名 [ WHERE 条件 ];
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ol>
<p><strong>注意：如果不加<code>WHERE</code>条件则默认操作整张表的数据</strong></p>
<h2 id="5-DQL（常用）"><a href="#5-DQL（常用）" class="headerlink" title="5.DQL（常用）"></a>5.DQL（常用）</h2><blockquote>
<p><strong><code>DQL</code>英文全称是<code>Data Query Language</code>(数据查询语言)，数据查询语言，用来查询数据库中表的记录。</strong></p>
</blockquote>
<p>小提示：</p>
<ul>
<li>查询关键字: <code>SELECT</code></li>
<li><code>DQL</code>是我们每天接触编写最多也是最难的SQL，该语言用来查询记录，不会修改数据库和表结构。</li>
<li>实际开发中<strong>查询操作</strong>的频次是要远高于<strong>增删改</strong>的。</li>
<li>查询可以当作一个很大的章节，其中包含<strong>单表查询、多表查询、分组查询</strong>等等。</li>
</ul>
<h3 id="5-1-课前准备"><a href="#5-1-课前准备" class="headerlink" title="5.1 课前准备"></a>5.1 课前准备</h3><blockquote>
<p><strong>在学习查询语句前我们需要用到一个图形化工具来操作数据库，这会使我们的学习效率及开发效率大大的提高。</strong></p>
</blockquote>
<ul>
<li><p>图形化界面工具（根据个人喜好选择）：<a target="_blank" rel="noopener" href="https://lanzoux.com/iHtYJ05vitze">Navicat15</a></p>
</li>
<li><p>在开始学习之前我们需要执行以下SQL语句作为我们的学习素材：</p>
<pre class="line-numbers language-none"><code class="language-none">CREATE DATABASE IF NOT EXISTS itcast DEFAULT CHARSET utf8mb4;
DROP TABLE IF EXISTS employee;

CREATE TABLE emp (
	id int COMMENT '编号',
	workno varchar(10) COMMENT '工号',
	name varchar(10) COMMENT '姓名',
	gender char(1) COMMENT '性别',
	age tinyint UNSIGNED COMMENT '年龄',
	idcard char(18) COMMENT '身份证号',
	workaddress varchar(50) COMMENT '工作地址',
	entrydate date COMMENT '入职时间'
) COMMENT '员工表';

INSERT INTO emp (id, workno, name, gender, age, idcard, workaddress, entrydate) VALUES (1, '00001', '柳岩666', '女', 20, '123456789012345678', '北京', '2000-01-01');
INSERT INTO emp (id, workno, name, gender, age, idcard, workaddress, entrydate) VALUES (2, '00002', '张无忌', '男', 18, '123456789012345670', '北京', '2005-09-01');
INSERT INTO emp (id, workno, name, gender, age, idcard, workaddress, entrydate) VALUES (3, '00003', '韦一笑', '男', 38, '123456789712345670', '上海', '2005-08-01'); 
INSERT INTO emp (id, workno, name, gender, age, idcard, workaddress, entrydate) VALUES (4, '00004', '赵敏', '女', 18, '123456757123845670', '北京', '2009-12-01'); 
INSERT INTO emp (id, workno, name, gender, age, idcard, workaddress, entrydate) VALUES (5, '00005', '小昭', '女', 16, '123456769012345678', '上海', '2007-07-01'); 
INSERT INTO emp (id, workno, name, gender, age, idcard, workaddress, entrydate) VALUES (6, '00006', '杨逍', '男', 28, '12345678931234567X', '北京', '2006-01-01'); 
INSERT INTO emp (id, workno, name, gender, age, idcard, workaddress, entrydate) VALUES (7, '00007', '范瑶', '男', 40, '123456789212345670', '北京', '2005-05-01'); 
INSERT INTO emp (id, workno, name, gender, age, idcard, workaddress, entrydate) VALUES (8, '00008', '黛绮丝', '女', 38, '123456157123645670', '天津', '2015-05-01'); 
INSERT INTO emp (id, workno, name, gender, age, idcard, workaddress, entrydate) VALUES (9, '00009', '范凉凉', '女', 45, '123156789012345678', '北京', '2010-04-01'); 
INSERT INTO emp (id, workno, name, gender, age, idcard, workaddress, entrydate) VALUES (10, '00010', '陈友谅', '男', 53, '123456789012345670', '上海', '2011-01-01'); 
INSERT INTO emp (id, workno, name, gender, age, idcard, workaddress, entrydate) VALUES (11, '00011', '张士诚', '男', 55, '123567897123465670', '江苏', '2015-05-01'); 
INSERT INTO emp (id, workno, name, gender, age, idcard, workaddress, entrydate) VALUES (12, '00012', '常遇春', '男', 32, '123446757152345670', '北京', '2004-02-01'); 
INSERT INTO emp (id, workno, name, gender, age, idcard, workaddress, entrydate) VALUES (13, '00013', '张三丰', '男', 88, '123656789012345678', '江苏', '2020-11-01'); 
INSERT INTO emp (id, workno, name, gender, age, idcard, workaddress, entrydate) VALUES (14, '00014', '灭绝', '女', 65, '123456719012345670', '西安', '2019-05-01'); 
INSERT INTO emp (id, workno, name, gender, age, idcard, workaddress, entrydate) VALUES (15, '00015', '胡青牛', '男', 70, '12345674971234567X', '西安', '2018-04-01'); 
INSERT INTO emp (id, workno, name, gender, age, idcard, workaddress, entrydate) VALUES (16, '00016', '周芷若', '女', 18, null, '北京', '2012-06-01');
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<h3 id="5-2-基本语法"><a href="#5-2-基本语法" class="headerlink" title="5.2 基本语法"></a>5.2 基本语法</h3><ul>
<li><p>DQL 查询语句，语法结构如下：</p>
<pre class="line-numbers language-none"><code class="language-none">SELECT
    字段列表
FROM
    表名字段
WHERE
    条件列表
GROUP BY
    分组字段列表
HAVING
    分组后的条件列表
ORDER BY
    排序字段列表
LIMIT
    分页参数
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>我们在学习的时候，会将上面的完整语法进行拆分，分为以下几个部分：</p>
<ul>
<li>基础查询（不带任何条件）</li>
<li>条件查询（<code>WHERE</code>）</li>
<li>聚合函数（<code>count</code>、<code>max</code>、<code>min</code>、<code>avg</code>、<code>sum</code>）</li>
<li>分组查询（<code>group by</code>）</li>
<li>排序查询（<code>order by</code>）</li>
<li>分页查询（<code>limit</code>）</li>
</ul>
</li>
</ul>
<h3 id="5-3-基础查询"><a href="#5-3-基础查询" class="headerlink" title="5.3 基础查询"></a>5.3 基础查询</h3><h4 id="a）语法格式"><a href="#a）语法格式" class="headerlink" title="a）语法格式"></a>a）语法格式</h4><ul>
<li><p>查询多个字段</p>
<pre class="line-numbers language-none"><code class="language-none">SELECT 字段1, 字段2, 字段3 ... FROM 表名 ;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">SELECT * FROM 表名 ;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>注意 : * 号代表查询所有字段，在实际开发中尽量少用（不直观、影响效率）。</strong></p>
</li>
<li><p>字段设置别名</p>
<pre class="line-numbers language-none"><code class="language-none">SELECT 字段1 [ AS 别名1 ], 字段2 [ AS 别名2 ], 字段3 [ AS 别名3 ], ... FROM 表名;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">SELECT 字段1 [ 别名1 ] , 字段2 [ 别名2 ] ... FROM 表名;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>去除重复记录</p>
<pre class="line-numbers language-none"><code class="language-none">SELECT DISTINCT 字段列表 FROM 表名;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<h4 id="b）案例练习"><a href="#b）案例练习" class="headerlink" title="b）案例练习"></a>b）案例练习</h4><ul>
<li><p>查询指定字段 <code>name</code>, <code>workno</code>, <code>age</code>并返回</p>
<pre class="line-numbers language-none"><code class="language-none">select name,workno,age from emp;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询返回所有字段</p>
<pre class="line-numbers language-none"><code class="language-none">select id, workno, name, gender, age, idcard, workaddress, entrydate from emp;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">select * from emp; #不推荐
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询所有员工的工作地址，起别名</p>
<pre class="line-numbers language-none"><code class="language-none">select workaddress AS '工作地址' from emp;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">select workaddress '工作地址' from emp; #省略AS的写法
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询公司员工的上班地址有哪些（不要重复）</p>
<pre class="line-numbers language-none"><code class="language-none">select DISTINCT workaddress from emp;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<h3 id="5-4-条件查询"><a href="#5-4-条件查询" class="headerlink" title="5.4 条件查询"></a>5.4 条件查询</h3><h4 id="a）语法格式-1"><a href="#a）语法格式-1" class="headerlink" title="a）语法格式"></a>a）语法格式</h4><ul>
<li><p>查询语句中使用<code>WHERE</code>条件</p>
<pre class="line-numbers language-none"><code class="language-none">SELECT 字段列表 FROM 表名 WHERE 条件列表 ;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<h4 id="b）条件运算符"><a href="#b）条件运算符" class="headerlink" title="b）条件运算符"></a>b）条件运算符</h4><ul>
<li><p>常用的比较运算符</p>
<table>
<thead>
<tr>
<th align="left">比较运算符</th>
<th align="left">功能</th>
</tr>
</thead>
<tbody><tr>
<td align="left">&gt;</td>
<td align="left">大于</td>
</tr>
<tr>
<td align="left">&gt;=</td>
<td align="left">大于等于</td>
</tr>
<tr>
<td align="left">&lt;</td>
<td align="left">小于</td>
</tr>
<tr>
<td align="left">&lt;=</td>
<td align="left">小于等于</td>
</tr>
<tr>
<td align="left">=</td>
<td align="left">等于</td>
</tr>
<tr>
<td align="left">&lt;&gt; 或 !=</td>
<td align="left">不等于</td>
</tr>
<tr>
<td align="left">BETWEEN … AND …</td>
<td align="left">在某个范围内（含最小、最大值）</td>
</tr>
<tr>
<td align="left">IN(…)</td>
<td align="left">在in之后的列表中的值，多选一</td>
</tr>
<tr>
<td align="left">LIKE 占位符</td>
<td align="left">模糊匹配（<code>_</code>匹配单个字符，<code>%</code>匹配任意个字符）</td>
</tr>
<tr>
<td align="left">IS NULL</td>
<td align="left">是NULL</td>
</tr>
</tbody></table>
</li>
<li><p>常用的逻辑运算符</p>
<table>
<thead>
<tr>
<th align="left">逻辑运算符</th>
<th align="left">功能</th>
</tr>
</thead>
<tbody><tr>
<td align="left">AND 或 &amp;&amp;</td>
<td align="left">并且（多个条件同时成立）</td>
</tr>
<tr>
<td align="left">OR 或 ||</td>
<td align="left">或者（多个条件任意一个成立）</td>
</tr>
<tr>
<td align="left">NOT 或 !</td>
<td align="left">非，不是</td>
</tr>
</tbody></table>
</li>
</ul>
<h4 id="c）案例练习"><a href="#c）案例练习" class="headerlink" title="c）案例练习"></a>c）案例练习</h4><ul>
<li><p>查询年龄等于 88 的员工</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp where age = 88;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询年龄小于 20 的员工信息</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp where age &lt; 20;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询年龄小于等于 20 的员工信息</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp where age &lt;= 20;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询没有身份证号的员工信息</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp where idcard is null;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询有身份证号的员工信息</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp where idcard is not null;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询年龄不等于 88 的员工信息</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp where age != 88;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">select * from emp where age &lt;&gt; 88;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询年龄在15岁（包含）到 20岁（包含）之间的员工信息</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp where age &gt;= 15 &amp;&amp; age &lt;= 20;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">select * from emp where age &gt;= 15 and age &lt;= 20;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">select * from emp where age BETWEEN 15 AND 20;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询性别为 女 且年龄小于 25岁的员工信息</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp where gender = '女' and age &lt; 25;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询年龄等于18 或 20 或 40 的员工信息</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp where age = 18 or age = 20 or age = 40;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">select * from emp where age in(18,20,40);
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询姓名为两个字的员工信息</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp where name like '__';
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询身份证号最后一位是X的员工信息</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp where idcard like '%X';
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<h3 id="5-5-聚合函数"><a href="#5-5-聚合函数" class="headerlink" title="5.5 聚合函数"></a>5.5 聚合函数</h3><blockquote>
<p><strong>将一列数据作为一个整体，进行纵向计算。</strong></p>
</blockquote>
<h4 id="a）常见的聚合函数"><a href="#a）常见的聚合函数" class="headerlink" title="a）常见的聚合函数"></a>a）常见的聚合函数</h4><table>
<thead>
<tr>
<th align="left">函数</th>
<th align="left">功能</th>
</tr>
</thead>
<tbody><tr>
<td align="left">count</td>
<td align="left">统计数量</td>
</tr>
<tr>
<td align="left">max</td>
<td align="left">最大值</td>
</tr>
<tr>
<td align="left">min</td>
<td align="left">最小值</td>
</tr>
<tr>
<td align="left">avg</td>
<td align="left">平均值</td>
</tr>
<tr>
<td align="left">sum</td>
<td align="left">求和</td>
</tr>
</tbody></table>
<h4 id="b）语法格式"><a href="#b）语法格式" class="headerlink" title="b）语法格式"></a>b）语法格式</h4><pre class="line-numbers language-none"><code class="language-none">SELECT 聚合函数(字段列表) FROM 表名 ;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>注意 : NULL值是不参与所有聚合函数运算的。</strong></p>
<h4 id="c）案例练习-1"><a href="#c）案例练习-1" class="headerlink" title="c）案例练习"></a>c）案例练习</h4><ul>
<li><p>统计该企业员工数量</p>
<pre class="line-numbers language-none"><code class="language-none">select count(*) from emp; #返回结果是16，统计的是总记录数
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">select count(idcard) from emp; #返回结果是15，统计的是idcard字段不为null的记录数
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">select count(1) from emp; #会统计表中的所有的记录数，包含字段为null 的记录
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>对于<code>count(*) </code>、<code>count(字段)</code>、 <code>count(1) </code>的具体原理，我们在进阶篇中SQL优化部分会详细讲解，此处大家只需要知道如何使用即可。</p>
</li>
<li><p>统计该企业员工的平均年龄</p>
<pre class="line-numbers language-none"><code class="language-none">select avg(age) from emp;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>统计该企业员工的最大年龄</p>
<pre class="line-numbers language-none"><code class="language-none">select max(age) from emp;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>统计该企业员工的最小年龄</p>
<pre class="line-numbers language-none"><code class="language-none">select min(age) from emp;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>统计西安地区员工的年龄之和</p>
<pre class="line-numbers language-none"><code class="language-none">select sum(age) from emp where workaddress = '西安';
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<h3 id="5-6-分组查询"><a href="#5-6-分组查询" class="headerlink" title="5.6 分组查询"></a>5.6 分组查询</h3><h4 id="a）-语法格式"><a href="#a）-语法格式" class="headerlink" title="a） 语法格式"></a>a） 语法格式</h4><pre class="line-numbers language-none"><code class="language-none">SELECT 字段列表 FROM 表名 [ WHERE 条件 ] GROUP BY 分组字段名 [ HAVING 分组 后过滤条件 ];
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="b）where与having区别"><a href="#b）where与having区别" class="headerlink" title="b）where与having区别"></a>b）where与having区别</h4><ul>
<li>执行时机不同：<code>where</code>是分组之前进行过滤，不满足<code>where</code>条件，不参与分组；而<code>having</code>是分组之后对结果进行过滤。</li>
<li>判断条件不同：<code>where</code>不能对聚合函数进行判断，而<code>having</code>可以。</li>
</ul>
<h4 id="c）案例练习-2"><a href="#c）案例练习-2" class="headerlink" title="c）案例练习"></a>c）案例练习</h4><ul>
<li><p>根据性别分组 , 统计男性员工 和 女性员工的数量</p>
<pre class="line-numbers language-none"><code class="language-none">select gender, count(*) from emp group by gender ;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>根据性别分组 , 统计男性员工 和 女性员工的平均年龄</p>
<pre class="line-numbers language-none"><code class="language-none">select gender, avg(age) from emp group by gender ;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询年龄小于45的员工 , 并根据工作地址分组 , 获取员工数量大于等于3的工作地址</p>
<pre class="line-numbers language-none"><code class="language-none">SELECT workaddress,count(*) address_count
FROM emp
WHERE age &lt; 45
GROUP BY  workaddress
HAVING address_count &gt;= 3;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>统计各个工作地址上班的男性及女性员工的数量</p>
<pre class="line-numbers language-none"><code class="language-none">select workaddress, gender, count(*) '数量' from emp group by gender , workaddress ;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<h3 id="5-7-排序查询"><a href="#5-7-排序查询" class="headerlink" title="5.7 排序查询"></a>5.7 排序查询</h3><blockquote>
<p>排序在日常开发中是非常常见的一个操作，有升序排序，也有降序排序。</p>
</blockquote>
<h4 id="a）语法格式-2"><a href="#a）语法格式-2" class="headerlink" title="a）语法格式"></a>a）语法格式</h4><pre class="line-numbers language-none"><code class="language-none">SELECT 字段列表 FROM 表名 ORDER BY 字段1 排序方式1, 字段2 排序方式2;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="b）排序方式"><a href="#b）排序方式" class="headerlink" title="b）排序方式"></a>b）排序方式</h4><ul>
<li><code>ASC</code>: 升序（默认）</li>
<li><code>DESC</code>: 降序</li>
</ul>
<p><strong>注意：如果是多字段排序，当第一个字段值相同时，才会根据第二个字段进行排序。</strong></p>
<h4 id="c）案例练习-3"><a href="#c）案例练习-3" class="headerlink" title="c）案例练习"></a>c）案例练习</h4><ul>
<li><p>根据年龄对公司的员工进行升序排序</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp order by age asc;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">select * from emp order by age;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>根据入职时间, 对员工进行降序排序</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp order by entrydate desc;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>根据年龄对公司的员工进行升序排序 , 年龄相同 , 再按照入职时间进行降序排序</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp order by age asc , entrydate desc;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<h3 id="5-8-分页查询"><a href="#5-8-分页查询" class="headerlink" title="5.8 分页查询"></a>5.8 分页查询</h3><blockquote>
<p>分页操作在业务系统开发时，也是非常常见的一个功能，我们在网站中看到的各种各样的分页条，后台都需要借助于数据库的分页操作。</p>
</blockquote>
<h4 id="a）语法格式-3"><a href="#a）语法格式-3" class="headerlink" title="a）语法格式"></a>a）语法格式</h4><pre class="line-numbers language-none"><code class="language-none">SELECT 字段列表 FROM 表名 LIMIT 起始索引, 查询记录数;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="b）注意事项"><a href="#b）注意事项" class="headerlink" title="b）注意事项"></a>b）注意事项</h4><ul>
<li>起始索引从<code>0</code>开始，==起始索引 = （查询页码 - 1）* 每页显示记录数==。</li>
<li>分页查询是数据库的方言，<strong>不同的数据库有不同的实现</strong>，<code>MySQL</code>中是<code>LIMIT</code>。</li>
<li>如果查询的是第一页数据，起始索引可以省略，直接简写为 limit 10。</li>
</ul>
<h4 id="c）案例练习-4"><a href="#c）案例练习-4" class="headerlink" title="c）案例练习"></a>c）案例练习</h4><ul>
<li><p>查询第1页员工数据, 每页展示10条记录</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp limit 10;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">select * from emp limit 0,10;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询第2页员工数据, 每页展示10条记录</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp limit 10,10;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<h3 id="5-9-执行顺序"><a href="#5-9-执行顺序" class="headerlink" title="5.9 执行顺序"></a>5.9 执行顺序</h3><blockquote>
<p>在讲解DQL语句的具体语法之前，我们已经讲解了DQL语句的完整语法，及编写顺序，接下来，我们要来说明的是DQL语句在执行时的执行顺序，也就是先执行那一部分，后执行那一部分。</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">FROM` ➤ `WHERE `➤ `GROUP BY` ➤ `SELECT `➤ `ORDER BY` ➤ `LIMIT<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://image-bed-vz.oss-cn-hangzhou.aliyuncs.com/MySQL/image-20220604130048234.png" alt="image-20220604130048234"></p>
<h2 id="6-DCL（不重要）"><a href="#6-DCL（不重要）" class="headerlink" title="6.DCL（不重要）"></a>6.DCL（不重要）</h2><blockquote>
<p><code>DCL</code>英文全称是**<code>Data Control Language</code>**(数据控制语言)，用来管理数据库用户、控制数据库的访问权限。</p>
<p>作为Java开发程序员的话，我们是无需关心DCL这一部分的，因为在实际工作中这不是我们所负责的内容！</p>
</blockquote>
<h3 id="6-1-用户管理"><a href="#6-1-用户管理" class="headerlink" title="6.1 用户管理"></a>6.1 用户管理</h3><ul>
<li><p>查询用户</p>
<pre class="line-numbers language-none"><code class="language-none">USER mysql;
SELECT * FROM user;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>创建用户</p>
<pre class="line-numbers language-none"><code class="language-none">CREATE USER '用户名'@'主机名' IDENTIFIED BY '密码';
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>修改用户密码</p>
<pre class="line-numbers language-none"><code class="language-none">ALTER USER '用户名'@'主机名' IDENTIFIED WITH mysql_native_password BY '新密码';
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>删除用户</p>
<pre class="line-numbers language-none"><code class="language-none">DROP USER '用户名'@'主机名';
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<p>注意：主机名可以使用 % 通配</p>
<h3 id="6-2-权限控制"><a href="#6-2-权限控制" class="headerlink" title="6.2 权限控制"></a>6.2 权限控制</h3><ul>
<li><p>常用权限</p>
<table>
<thead>
<tr>
<th align="left">权限</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ALL, ALL PRIVILEGES</td>
<td align="left">所有权限</td>
</tr>
<tr>
<td align="left">SELECT</td>
<td align="left">查询数据</td>
</tr>
<tr>
<td align="left">INSERT</td>
<td align="left">插入数据</td>
</tr>
<tr>
<td align="left">UPDATE</td>
<td align="left">修改数据</td>
</tr>
<tr>
<td align="left">DELETE</td>
<td align="left">删除数据</td>
</tr>
<tr>
<td align="left">ALTER</td>
<td align="left">修改表</td>
</tr>
<tr>
<td align="left">DROP</td>
<td align="left">删除数据库/表/视图</td>
</tr>
<tr>
<td align="left">CREATE</td>
<td align="left">创建数据库/表</td>
</tr>
</tbody></table>
</li>
<li><p>查询权限</p>
<pre class="line-numbers language-none"><code class="language-none">SHOW GRANTS FOR '用户名'@'主机名';
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>授予权限</p>
<pre class="line-numbers language-none"><code class="language-none">GRANT 权限列表 ON 数据库名.表名 TO '用户名'@'主机名';
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>撤销权限</p>
<pre class="line-numbers language-none"><code class="language-none">REVOKE 权限列表 ON 数据库名.表名 FROM '用户名'@'主机名';
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>注意事项</p>
<ul>
<li>多个权限用逗号分隔</li>
<li>授权时，数据库名和表名可以用 <code>*</code> 进行通配，代表所有</li>
</ul>
</li>
</ul>
<h1 id="二、函数"><a href="#二、函数" class="headerlink" title="二、函数"></a>二、函数</h1><blockquote>
<p> ==函数==是指一段可以<strong>直接被另一段程序调用</strong>的程序或代码。 也就意味着，这一段程序或代码在<code>MySQL</code>中已经给我们提供了，我们要做的就是在合适的业务场景调用对应的函数完成对应的业务需求即可。</p>
</blockquote>
<p>Ps：其实很少用到函数的，可以说基本用不到，所以我这就不记那么详细了。</p>
<h2 id="1-字符串函数"><a href="#1-字符串函数" class="headerlink" title="1.字符串函数"></a>1.字符串函数</h2><ul>
<li><p>常用函数</p>
<table>
<thead>
<tr>
<th align="left">函数</th>
<th align="left">功能</th>
</tr>
</thead>
<tbody><tr>
<td align="left">CONCAT(s1, s2, …, sn)</td>
<td align="left">字符串拼接，将s1, s2, …, sn拼接成一个字符串</td>
</tr>
<tr>
<td align="left">LOWER(str)</td>
<td align="left">将字符串全部转为小写</td>
</tr>
<tr>
<td align="left">UPPER(str)</td>
<td align="left">将字符串全部转为大写</td>
</tr>
<tr>
<td align="left">LPAD(str, n, pad)</td>
<td align="left">左填充，用字符串pad对str的左边进行填充，达到n个字符串长度</td>
</tr>
<tr>
<td align="left">RPAD(str, n, pad)</td>
<td align="left">右填充，用字符串pad对str的右边进行填充，达到n个字符串长度</td>
</tr>
<tr>
<td align="left">TRIM(str)</td>
<td align="left">去掉字符串头部和尾部的空格</td>
</tr>
<tr>
<td align="left">SUBSTRING(str, start, len)</td>
<td align="left">返回从字符串str从start位置起的len个长度的字符串</td>
</tr>
</tbody></table>
</li>
<li><p>使用示例</p>
<pre class="line-numbers language-none"><code class="language-none">-- 拼接
SELECT CONCAT('Hello', 'World');
-- 小写
SELECT LOWER('Hello');
-- 大写
SELECT UPPER('Hello');
-- 左填充
SELECT LPAD('01', 5, '-');
-- 右填充
SELECT RPAD('01', 5, '-');
-- 去除空格
SELECT TRIM(' Hello World ');
-- 切片（起始索引为1）
SELECT SUBSTRING('Hello World', 1, 5);
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<h2 id="2-数值函数"><a href="#2-数值函数" class="headerlink" title="2.数值函数"></a>2.数值函数</h2><table>
<thead>
<tr>
<th align="left">函数</th>
<th align="left">功能</th>
</tr>
</thead>
<tbody><tr>
<td align="left">CEIL(x)</td>
<td align="left">向上取整</td>
</tr>
<tr>
<td align="left">FLOOR(x)</td>
<td align="left">向下取整</td>
</tr>
<tr>
<td align="left">MOD(x, y)</td>
<td align="left">返回x/y的模</td>
</tr>
<tr>
<td align="left">RAND()</td>
<td align="left">返回0~1内的随机数</td>
</tr>
<tr>
<td align="left">ROUND(x, y)</td>
<td align="left">求参数x的四舍五入值，保留y位小数</td>
</tr>
</tbody></table>
<h2 id="3-日期函数"><a href="#3-日期函数" class="headerlink" title="3.日期函数"></a>3.日期函数</h2><table>
<thead>
<tr>
<th align="left">函数</th>
<th align="left">功能</th>
</tr>
</thead>
<tbody><tr>
<td align="left">CURDATE()</td>
<td align="left">返回当前日期</td>
</tr>
<tr>
<td align="left">CURTIME()</td>
<td align="left">返回当前时间</td>
</tr>
<tr>
<td align="left">NOW()</td>
<td align="left">返回当前日期和时间</td>
</tr>
<tr>
<td align="left">YEAR(date)</td>
<td align="left">获取指定date的年份</td>
</tr>
<tr>
<td align="left">MONTH(date)</td>
<td align="left">获取指定date的月份</td>
</tr>
<tr>
<td align="left">DAY(date)</td>
<td align="left">获取指定date的日期</td>
</tr>
<tr>
<td align="left">DATE_ADD(date, INTERVAL expr type)</td>
<td align="left">返回一个日期/时间值加上一个时间间隔expr后的时间值</td>
</tr>
<tr>
<td align="left">DATEDIFF(date1, date2)</td>
<td align="left">返回起始时间date1和结束时间date2之间的天数</td>
</tr>
</tbody></table>
<h2 id="4-流程函数"><a href="#4-流程函数" class="headerlink" title="4.流程函数"></a>4.流程函数</h2><table>
<thead>
<tr>
<th align="left">函数</th>
<th align="left">功能</th>
</tr>
</thead>
<tbody><tr>
<td align="left">IF(value, t, f)</td>
<td align="left">如果value为true，则返回t，否则返回f</td>
</tr>
<tr>
<td align="left">IFNULL(value1, value2)</td>
<td align="left">如果value1不为空，返回value1，否则返回value2</td>
</tr>
<tr>
<td align="left">CASE WHEN [ val1 ] THEN [ res1 ] … ELSE [ default ] END</td>
<td align="left">如果val1为true，返回res1，… 否则返回default默认值</td>
</tr>
<tr>
<td align="left">CASE [ expr ] WHEN [ val1 ] THEN [ res1 ] … ELSE [ default ] END</td>
<td align="left">如果expr的值等于val1，返回res1，… 否则返回default默认值</td>
</tr>
</tbody></table>
<h1 id="三、约束"><a href="#三、约束" class="headerlink" title="三、约束"></a>三、约束</h1><blockquote>
<p>约束是作用于表中字段上的规则，用于限制存储在表中的数据。</p>
</blockquote>
<p>Ps：我们仅需了解约束的含义即可，实际开发中这都是在建表时就已经确定了的。</p>
<h2 id="1-常用约束"><a href="#1-常用约束" class="headerlink" title="1.常用约束"></a>1.常用约束</h2><table>
<thead>
<tr>
<th align="left">约束</th>
<th align="left">描述</th>
<th align="left">关键字</th>
</tr>
</thead>
<tbody><tr>
<td align="left">非空约束</td>
<td align="left">限制该字段的数据不能为null</td>
<td align="left">NOT NULL</td>
</tr>
<tr>
<td align="left">唯一约束</td>
<td align="left">保证该字段的所有数据都是唯一、不重复的</td>
<td align="left">UNIQUE</td>
</tr>
<tr>
<td align="left">主键约束</td>
<td align="left">主键是一行数据的唯一标识，要求非空且唯一</td>
<td align="left">PRIMARY KEY</td>
</tr>
<tr>
<td align="left">默认约束</td>
<td align="left">保存数据时，如果未指定该字段的值，则采用默认值</td>
<td align="left">DEFAULT</td>
</tr>
<tr>
<td align="left">检查约束（8.0.1版本后）</td>
<td align="left">保证字段值满足某一个条件</td>
<td align="left">CHECK</td>
</tr>
<tr>
<td align="left">外键约束</td>
<td align="left">用来让两张图的数据之间建立连接，保证数据的一致性和完整性</td>
<td align="left">FOREIGN KEY</td>
</tr>
</tbody></table>
<p>约束是作用于表中字段上的，可以在创建表/修改表的时候添加约束。</p>
<h2 id="2-外键约束"><a href="#2-外键约束" class="headerlink" title="2.外键约束"></a>2.外键约束</h2><blockquote>
<p>用来让两张表的数据之间建立连接，从而保证数据的一致性和完整性</p>
</blockquote>
<ul>
<li><p>建表时添加外键约束</p>
<pre class="line-numbers language-none"><code class="language-none">CREATE TABLE 表名(
    字段名 字段类型,
    ...
    [CONSTRAINT] [外键名称] FOREIGN KEY(外键字段名) REFERENCES 主表(主表列名)
);
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>建表后添加外键约束</p>
<pre class="line-numbers language-none"><code class="language-none">ALTER TABLE 表名 ADD CONSTRAINT 外键名称 FOREIGN KEY (外键字段名) REFERENCES 主表(主表列名);
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>删除外键</p>
<pre class="line-numbers language-none"><code class="language-none">ALTER TABLE 表名 DROP FOREIGN KEY 外键名;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<blockquote>
<p>删除/更新行为</p>
</blockquote>
<table>
<thead>
<tr>
<th align="left">行为</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">NO ACTION</td>
<td align="left">当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则不允许删除/更新（与RESTRICT一致）</td>
</tr>
<tr>
<td align="left">RESTRICT</td>
<td align="left">当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则不允许删除/更新（与NO ACTION一致）</td>
</tr>
<tr>
<td align="left">CASCADE</td>
<td align="left">当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则也删除/更新外键在子表中的记录</td>
</tr>
<tr>
<td align="left">SET NULL</td>
<td align="left">当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则设置子表中该外键值为null（要求该外键允许为null）</td>
</tr>
<tr>
<td align="left">SET DEFAULT</td>
<td align="left">父表有变更时，子表将外键设为一个默认值（Innodb不支持）</td>
</tr>
</tbody></table>
<p>更改删除/更新行为</p>
<pre class="line-numbers language-none"><code class="language-none">ALTER TABLE 表名 ADD CONSTRAINT 外键名称 FOREIGN KEY (外键字段) REFERENCES 主表名(主表字段名) ON UPDATE 行为 ON DELETE 行为;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h1 id="三、多表查询"><a href="#三、多表查询" class="headerlink" title="三、多表查询"></a>三、多表查询</h1><blockquote>
<p> 我们之前在讲解SQL语句的时候，讲解了DQL语句，也就是数据查询语句，但是之前讲解的查询都是单表查询，而本章节我们要学习的则是多表查询操作。</p>
</blockquote>
<p>Ps：相较于约束来讲，本章确实是个重点，多表联查会在开发中经常用到，因此需要认真学习！！！</p>
<h2 id="1-多表关系"><a href="#1-多表关系" class="headerlink" title="1.多表关系"></a>1.多表关系</h2><p> 项目开发中，在进行数据库表结构设计时，会根据业务需求及业务模块之间的关系，分析并设计表结构，由于业务之间相互关联，所以各个表结构之间也存在着各种联系，基本上分为三种：</p>
<ol>
<li><strong>一对多（多对一）</strong></li>
<li><strong>多对多</strong></li>
<li><strong>一对一</strong></li>
</ol>
<h3 id="1-1-一对多"><a href="#1-1-一对多" class="headerlink" title="1.1 一对多"></a>1.1 一对多</h3><ul>
<li>案例：部门 与 员工的关系</li>
<li>关系：一个部门对应多个员工，一个员工对应一个部门</li>
<li>实现：在多的一方建立外键，指向一的一方的主键</li>
</ul>
<p><img src="https://image-bed-vz.oss-cn-hangzhou.aliyuncs.com/MySQL/image-20220604201130760.png" alt="image-20220604201130760"></p>
<h3 id="1-2-多对多"><a href="#1-2-多对多" class="headerlink" title="1.2 多对多"></a>1.2 多对多</h3><ul>
<li>案例：学生 与 课程的关系</li>
<li>关系：一个学生可以选修多门课程，一门课程也可以供多个学生选择</li>
<li>实现：建立第三张中间表，中间表至少包含两个外键，分别关联两方主键</li>
</ul>
<p><img src="https://image-bed-vz.oss-cn-hangzhou.aliyuncs.com/MySQL/image-20220604201411978.png" alt="image-20220604201411978"></p>
<h3 id="1-3-一对一"><a href="#1-3-一对一" class="headerlink" title="1.3 一对一"></a>1.3 一对一</h3><ul>
<li>案例：用户 与 用户详情的关系</li>
<li>关系：一对一关系，多用于单表拆分，将一张表的基础字段放在一张表中，其他详情字段放在另一张表中，以提升操作效率</li>
<li>实现：在任意一方加入外键，关联另外一方的主键，并且设置外键为唯一的(UNIQUE)</li>
</ul>
<p><img src="https://image-bed-vz.oss-cn-hangzhou.aliyuncs.com/MySQL/image-20220604201513196.png" alt="image-20220604201513196"></p>
<h2 id="2-多表查询概述"><a href="#2-多表查询概述" class="headerlink" title="2.多表查询概述"></a>2.多表查询概述</h2><h3 id="2-1-数据准备"><a href="#2-1-数据准备" class="headerlink" title="2.1 数据准备"></a>2.1 数据准备</h3><ul>
<li><p>删除之前的 emp, dept表</p>
</li>
<li><p>执行下面SQL语句</p>
<pre class="line-numbers language-none"><code class="language-none">CREATE TABLE dept (
	id int PRIMARY KEY AUTO_INCREMENT COMMENT 'ID',
	name varchar(50) NOT NULL COMMENT '部门名称'
) COMMENT '部门表';
INSERT INTO dept (id, name) VALUES (1, '研发部'), (2, '市场部'),(3, '财务部'), (4, '销售部'), (5, '总经办'), (6, '人事部');

CREATE TABLE emp (
	id int PRIMARY KEY AUTO_INCREMENT COMMENT 'ID',
	name varchar(50) NOT NULL COMMENT '姓名',
	age int COMMENT '年龄',
	job varchar(20) COMMENT '职位',
	salary int COMMENT '薪资',
	entrydate date COMMENT '入职时间',
	managerid int COMMENT '直属领导ID',
	dept_id int COMMENT '部门ID'
) COMMENT '员工表';
alter table emp add constraint fk_emp_dept_id foreign key (dept_id) references dept(id);

INSERT INTO emp (id, name, age, job,salary, entrydate, managerid, dept_id)
VALUES
    (1, '金庸', 66, '总裁', 20000, '2000-01-01', null, 5),
    (2, '张无忌', 20, '项目经理', 12500, '2005-12-05', 1, 1),
    (3, '杨逍', 33, '开发', 8400, '2000-11-03', 2, 1),
    (4, '韦一笑', 48, '开发', 11000, '2002-02-05', 2, 1),
    (5, '常遇春', 43, '开发', 10500, '2004-09-07', 3, 1),
    (6, '小昭', 19, '程序员鼓励师', 6600, '2004-10-12', 2, 1),
    (7, '灭绝', 60, '财务总监', 8500, '2002-09-12', 1, 3),
    (8, '周芷若', 19, '会计', 48000, '2006-06-02', 7, 3),
    (9, '丁敏君', 23, '出纳', 5250, '2009-05-13', 7, 3),
    (10, '赵敏', 20, '市场部总监', 12500, '2004-10-12', 1, 2),
    (11, '鹿杖客', 56, '职员', 3750, '2006-10-03', 10, 2),
    (12, '鹤笔翁', 19, '职员', 3750, '2007-05-09', 10, 2),
    (13, '方东白', 19, '职员', 5500, '2009-02-12', 10, 2),
    (14, '张三丰', 88, '销售总监', 14000, '2004-10-12', 1, 4),
    (15, '俞莲舟', 38, '销售', 4600, '2004-10-12', 14, 4),
    (16, '宋远桥', 40, '销售', 4600, '2004-10-12', 14, 4),
    (17, '陈友谅', 42, null, 2000, '2011-10-12', 1, null);
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<h3 id="2-2-笛卡尔积"><a href="#2-2-笛卡尔积" class="headerlink" title="2.2 笛卡尔积"></a>2.2 笛卡尔积</h3><blockquote>
<p>笛卡尔乘积是指在数学中，两个集合 A集合 和 B集合 的所有组合情况。</p>
</blockquote>
<ul>
<li><p>这是我们查单表的SQL语句</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>那么我们要执行多表查询，就只需要使用逗号分隔多张表即可</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp , dept;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>但是这个时候查出来的结果却是102条记录</p>
<p><img src="https://image-bed-vz.oss-cn-hangzhou.aliyuncs.com/MySQL/image-20220605080339628.png" alt="image-20220605080339628"></p>
<p>与 部门表dept所有记录(6) 的所有组合情况，这种现象称之为笛卡尔积。</p>
</li>
</ul>
<blockquote>
<p>在SQL语句中，如何来去除无效的笛卡尔积呢？ 我们可以给多表查询加上连接查询的条件即可。</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">select * from emp , dept where emp.dept_id = dept.id;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="https://image-bed-vz.oss-cn-hangzhou.aliyuncs.com/MySQL/image-20220605080630910.png" alt="image-20220605080630910"></p>
<p>而由于id为17的员工，没有<code>dept_id</code>字段值，所以在多表查询时，根据连接查询的条件并没有查询到。</p>
<h3 id="2-3-分类"><a href="#2-3-分类" class="headerlink" title="2.3 分类"></a>2.3 分类</h3><blockquote>
<p>多表查询又分为以下两大类：</p>
</blockquote>
<ul>
<li>连接查询<ul>
<li>内连接：相当于查询A、B交集部分数据</li>
<li>外连接：<ul>
<li>左外连接：查询左表所有数据，以及两张表交集部分数据</li>
<li>右外连接：查询右表所有数据，以及两张表交集部分数据</li>
</ul>
</li>
<li>自连接：当前表与自身的连接查询，自连接必须使用表别名</li>
</ul>
</li>
<li>子查询</li>
</ul>
<h2 id="3-内连接"><a href="#3-内连接" class="headerlink" title="3.内连接"></a>3.内连接</h2><blockquote>
<p>内连接查询的是两张表交集部分的数据。(也就是绿色部分的数据)</p>
</blockquote>
<p><img src="https://image-bed-vz.oss-cn-hangzhou.aliyuncs.com/MySQL/image-20220605081106113.png" alt="image-20220605081106113"></p>
<p>内连接的语法分为两种：<strong>隐式内连接</strong>、<strong>显式内连接</strong>。</p>
<h3 id="3-1-语法格式"><a href="#3-1-语法格式" class="headerlink" title="3.1 语法格式"></a>3.1 语法格式</h3><ul>
<li><p>隐式内连接</p>
<pre class="line-numbers language-none"><code class="language-none">SELECT 字段列表 FROM 表1 , 表2 WHERE 条件 ... ;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>显式内连接</p>
<pre class="line-numbers language-none"><code class="language-none">SELECT 字段列表 FROM 表1 [ INNER ] JOIN 表2 ON 连接条件 ... ;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<h3 id="3-2-案例练习"><a href="#3-2-案例练习" class="headerlink" title="3.2 案例练习"></a>3.2 案例练习</h3><ul>
<li>查询每一个员工的姓名 , 及关联的部门的名称 (隐式内连接实现)</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">select e.`name`, d.`name` from emp e,dept d where e.dept_id = d.id;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li><p>查询每一个员工的姓名 , 及关联的部门的名称 (显式内连接实现)</p>
<pre class="line-numbers language-none"><code class="language-none">select e.`name`, d.`name` from emp e join dept d on e.dept_id = d.id;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<h2 id="4-外连接"><a href="#4-外连接" class="headerlink" title="4.外连接"></a>4.外连接</h2><blockquote>
<p>外连接和内连接一样查询的都是两个表交集的数据，不同的是左外连接会查询左表的全部数据以及交集数据，右外连接与之相对。</p>
</blockquote>
<p><img src="https://image-bed-vz.oss-cn-hangzhou.aliyuncs.com/MySQL/image-20220605081106113.png" alt="image-20220605081106113"></p>
<h3 id="4-1-语法格式"><a href="#4-1-语法格式" class="headerlink" title="4.1 语法格式"></a>4.1 语法格式</h3><ul>
<li><p>左外连接</p>
<pre class="line-numbers language-none"><code class="language-none">SELECT 字段列表 FROM 表1 LEFT [ OUTER ] JOIN 表2 ON 条件 ... ;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>右外连接</p>
<pre class="line-numbers language-none"><code class="language-none">SELECT 字段列表 FROM 表1 RIGHT [ OUTER ] JOIN 表2 ON 条件 ...;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<h3 id="4-2-案例练习"><a href="#4-2-案例练习" class="headerlink" title="4.2 案例练习"></a>4.2 案例练习</h3><ul>
<li><p>查询<code>emp</code>表的所有数据, 和对应的部门信息（左外）</p>
<pre class="line-numbers language-none"><code class="language-none">select e.*,d.name from emp e left join dept d on e.dept_id = d.id;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询<code>dept</code>表的所有数据, 和对应的员工信息（右外）</p>
<pre class="line-numbers language-none"><code class="language-none">select e.*,d.name from emp e right join dept d on e.dept_id = d.id;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<p> 左外连接和右外连接是可以相互替换的，只需要调整在连接查询时SQL中，表结构的先后顺序就可以了。而我们在日常开发使用时，更偏向于左外连接。</p>
<h2 id="5-自连接"><a href="#5-自连接" class="headerlink" title="5.自连接"></a>5.自连接</h2><h3 id="5-1-自链接查询"><a href="#5-1-自链接查询" class="headerlink" title="5.1 自链接查询"></a>5.1 自链接查询</h3><blockquote>
<p>当前表与自身的连接查询，自连接必须使用表别名</p>
</blockquote>
<ul>
<li><p>语法格式</p>
<pre class="line-numbers language-none"><code class="language-none">SELECT 字段列表 FROM 表A 别名A JOIN 表A 别名B ON 条件 ...;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>自连接查询，可以是内连接查询，也可以是外连接查询</p>
</li>
<li><p>案例练习</p>
<pre class="line-numbers language-none"><code class="language-none">-- 查询员工及其所属领导的名字
select a.name, b.name from employee a, employee b where a.manager = b.id;
-- 没有领导的也查询出来
select a.name, b.name from employee a left join employee b on a.manager = b.id;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<h3 id="5-2-联合查询"><a href="#5-2-联合查询" class="headerlink" title="5.2 联合查询"></a>5.2 联合查询</h3><blockquote>
<p>把多次查询的结果合并，形成一个新的查询集，其实就是吧两个查询语句给连起来了。</p>
</blockquote>
<ul>
<li><p>语法格式</p>
<pre class="line-numbers language-none"><code class="language-none">SELECT 字段列表 FROM 表A ...
UNION [ALL]
SELECT 字段列表 FROM 表B ...
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>注意事项</p>
<ul>
<li>UNION ALL 会有重复结果，UNION 不会</li>
<li>联合查询比使用or效率高，不会使索引失效</li>
</ul>
</li>
</ul>
<h2 id="6-子查询"><a href="#6-子查询" class="headerlink" title="6.子查询"></a>6.子查询</h2><h3 id="6-1-概述"><a href="#6-1-概述" class="headerlink" title="6.1 概述"></a>6.1 概述</h3><blockquote>
<p>SQL语句中嵌套SELECT语句，称为嵌套查询，又称子查询。</p>
</blockquote>
<ul>
<li><p>语法格式</p>
<pre class="line-numbers language-none"><code class="language-none">SELECT * FROM t1 WHERE column1 = ( SELECT column1 FROM t2);
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>子查询外部的语句可以是<code>INSERT </code>/ <code>UPDATE </code>/ <code>DELETE </code>/ <code>SELECT </code>的任何一个。</p>
</li>
<li><p>根据子查询结果不同，分为：</p>
<ul>
<li>标量子查询（子查询结果为单个值）</li>
<li>列子查询（子查询结果为一列）</li>
<li>行子查询（子查询结果为一行）</li>
<li>表子查询（子查询结果为多行多列）</li>
</ul>
</li>
<li><p>根据子查询位置，分为：</p>
<ul>
<li>WHERE 之后</li>
<li>FROM 之后</li>
<li>SELECT 之后</li>
</ul>
</li>
</ul>
<h3 id="6-2-标量子查询"><a href="#6-2-标量子查询" class="headerlink" title="6.2 标量子查询"></a>6.2 标量子查询</h3><blockquote>
<p>子查询返回的结果是单个值（数字、字符串、日期等），最简单的形式，这种子查询称为标量子查询。</p>
</blockquote>
<p>常用操作符：<code>- &lt; &gt; &gt; &gt;= &lt; &lt;=</code></p>
<p>案例练习：</p>
<ul>
<li><p>查询 “销售部” 的所有员工信息</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp where dept_id = (select id from dept where name = '销售部');
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询在 “方东白” 入职之后的员工信息</p>
</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">select * from emp where entrydate &gt; (select entrydate from emp where name = '方东白');
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="6-3-列子查询"><a href="#6-3-列子查询" class="headerlink" title="6.3 列子查询"></a>6.3 列子查询</h3><blockquote>
<p>子查询返回的结果是一列（可以是多行），这种子查询称为列子查询。</p>
</blockquote>
<p>常用的操作符：<code>IN 、NOT IN 、 ANY 、SOME 、 ALL</code></p>
<table>
<thead>
<tr>
<th align="left">操作符</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">IN</td>
<td align="left">在指定的集合范围内，多选一</td>
</tr>
<tr>
<td align="left">NOT IN</td>
<td align="left">不在指定的集合范围内</td>
</tr>
<tr>
<td align="left">ANY</td>
<td align="left">子查询返回列表中，有任意一个满足即可</td>
</tr>
<tr>
<td align="left">SOME</td>
<td align="left">与ANY等同，使用SOME的地方都可以使用ANY</td>
</tr>
<tr>
<td align="left">ALL</td>
<td align="left">子查询返回列表的所有值都必须满足</td>
</tr>
</tbody></table>
<p>案例练习：</p>
<ul>
<li><p>查询 “销售部” 和 “市场部” 的所有员工信息</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp where dept_id in (select id from dept where name = '销售部' or name = '市场部');
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询比 “财务部” 所有人工资都高的员工信息</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp where salary &gt; all ( select salary from emp where dept_id = (select id from dept where name = '财务部') );
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询比研发部其中任意一人工资高的员工信息</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp where salary &gt; any ( select salary from emp where dept_id = (select id from dept where name = '研发部') );
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<h3 id="6-4-行子查询"><a href="#6-4-行子查询" class="headerlink" title="6.4 行子查询"></a>6.4 行子查询</h3><blockquote>
<p>子查询返回的结果是一行（可以是多列），这种子查询称为行子查询。</p>
</blockquote>
<p>常用的操作符：<code>= 、&lt;&gt; 、IN 、NOT IN</code></p>
<p>案例练习：</p>
<ul>
<li>查询与 “张无忌” 的薪资及直属领导相同的员工信息 ;</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">select * from emp where (salary,managerid) = (select salary, managerid from emp where name = '张无忌');
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="6-5-表子查询"><a href="#6-5-表子查询" class="headerlink" title="6.5 表子查询"></a>6.5 表子查询</h3><blockquote>
<p>子查询返回的结果是多行多列，这种子查询称为表子查询。</p>
</blockquote>
<p>常用操作符：<code>IN</code></p>
<p>案例练习：</p>
<ul>
<li><p>查询与 “鹿杖客” , “宋远桥” 的职位和薪资相同的员工信息</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp where (job,salary) in ( select job, salary from emp where name = '鹿杖客' or name = '宋远桥' );
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询入职日期是 “2006-01-01” 之后的员工信息 , 及其部门信息</p>
<pre class="line-numbers language-none"><code class="language-none">select e.*, d.* from (select * from emp where entrydate &gt; '2006-01-01') e left join dept d on e.dept_id = d.id ;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<h1 id="四、事务"><a href="#四、事务" class="headerlink" title="四、事务"></a>四、事务</h1><h2 id="1-事务简介"><a href="#1-事务简介" class="headerlink" title="1.事务简介"></a>1.事务简介</h2><blockquote>
<p> <strong>事务</strong>是一组操作的集合，它是一个不可分割的工作单位，事务会把所有的操作作为一个整体一起向系统提交或撤销操作请求，即这些操作要么同时成功，要么同时失败。</p>
</blockquote>
<p>举例说明：</p>
<p> 张三给李四转账1000块钱，张三银行账户的钱==减少1000==，而李四银行账户的钱要==增加1000==。 这一组操作就必须在一个事务的范围内，<strong>要么都成功</strong>，<strong>要么都失败</strong>。</p>
<p><img src="https://image-bed-vz.oss-cn-hangzhou.aliyuncs.com/MySQL/image-20220605121214330.png" alt="image-20220605121214330"></p>
<p><strong>注意： 默认MySQL的事务是自动提交的，也就是说，当执行完一条DML语句时，MySQL会立即隐式的提交事务。</strong></p>
<h2 id="2-事务操作"><a href="#2-事务操作" class="headerlink" title="2.事务操作"></a>2.事务操作</h2><h3 id="2-1-数据准备-1"><a href="#2-1-数据准备-1" class="headerlink" title="2.1 数据准备"></a>2.1 数据准备</h3><blockquote>
<p>在开始学习事务之前需要先执行以下SQL语句来导入数据。</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">drop table if exists account;

create table account(
    id int primary key AUTO_INCREMENT comment 'ID',
    name varchar(10) comment '姓名',
    money double(10, 2) comment '余额'
) comment '账户表';

insert into account(name, money) VALUES ('张三', 2000),('李四', 2000);
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-2-未控制事务"><a href="#2-2-未控制事务" class="headerlink" title="2.2 未控制事务"></a>2.2 未控制事务</h3><blockquote>
<p>当前情境下事务是MySQL默认的事务，也就是每执行一句更新操作都将由MySQL自动隐式提交。</p>
</blockquote>
<ul>
<li><p>测试转账操作的正常情况</p>
<pre class="line-numbers language-none"><code class="language-none">-- 1. 查询张三余额 
select * from account where name = '张三'; 
-- 2. 张三的余额减少1000 
update account set money = money - 1000 where name = '张三'; 
-- 3. 李四的余额增加1000 
update account set money = money + 1000 where name = '李四';
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://image-bed-vz.oss-cn-hangzhou.aliyuncs.com/MySQL/image-20220605122748424.png" alt="image-20220605122748424"></p>
</li>
<li><p>测试异常情况（执行之前先将两个人的余额都恢复到2000）</p>
<pre class="line-numbers language-none"><code class="language-none">-- 1. 查询张三余额 
select * from account where name = '张三'; 
-- 2. 张三的余额减少1000 
update account set money = money - 1000 where name = '张三'; 
出错了...
-- 3. 李四的余额增加1000 
update account set money = money + 1000 where name = '李四';
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://image-bed-vz.oss-cn-hangzhou.aliyuncs.com/MySQL/image-20220605123015353.png" alt="image-20220605123015353"></p>
</li>
</ul>
<p> 通过上面的两种情况演示，我们得知如果是异常情况的话，这种错误是非常致命的，假如真的是两个人之间的转账，一方钱减少了，另一方却没有增加的话，用户必定会勃然大怒，因此我们需要通过控制事务的方式来避免这种情况的出现！</p>
<h3 id="2-3-控制事务一（不常用）"><a href="#2-3-控制事务一（不常用）" class="headerlink" title="2.3 控制事务一（不常用）"></a>2.3 控制事务一（不常用）</h3><ul>
<li><p>查看/设置事务提交方式</p>
<pre class="line-numbers language-none"><code class="language-none">SELECT @@autocommit ; 
SET @@autocommit = 0 ;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>提交事务</p>
<pre class="line-numbers language-none"><code class="language-none">COMMIT;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>回滚事务</p>
<pre class="line-numbers language-none"><code class="language-none">ROLLBACK;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<p><strong>注意</strong>：上述的这种方式，我们是修改了事务的自动提交行为, 把默认的自动提交修改为了手动提交, 此时我们执行的DML语句都不会提交, 需要手动的执行<code>commit</code>进行提交。</p>
<h3 id="2-4-控制事务二（常用）"><a href="#2-4-控制事务二（常用）" class="headerlink" title="2.4 控制事务二（常用）"></a>2.4 控制事务二（常用）</h3><ul>
<li><p>开启事务</p>
<pre class="line-numbers language-none"><code class="language-none">START TRANSACTION 或 BEGIN TRANSACTION;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>提交事务</p>
<pre class="line-numbers language-none"><code class="language-none">COMMIT;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>回滚事务</p>
<pre class="line-numbers language-none"><code class="language-none">ROLLBACK;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<h3 id="2-5-转账案例"><a href="#2-5-转账案例" class="headerlink" title="2.5 转账案例"></a>2.5 转账案例</h3><blockquote>
<p>接下来通过控制事务的方式演示一遍转账操作。</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">-- 开启事务 
start transaction 
-- 1. 查询张三余额 
select * from account where name = '张三'; 
-- 2. 张三的余额减少1000 
update account set money = money - 1000 where name = '张三'; 
-- 3. 李四的余额增加1000 
update account set money = money + 1000 where name = '李四'; 
-- 如果正常执行完毕, 则提交事务 
commit; 
-- 如果执行过程中报错, 则回滚事务 
-- rollback;
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="3-事务四大特性（ACID）"><a href="#3-事务四大特性（ACID）" class="headerlink" title="3.事务四大特性（ACID）"></a>3.事务四大特性（ACID）</h2><ul>
<li>原子性(<code>Atomicity</code>)：事务是不可分割的最小操作但愿，要么全部成功，要么全部失败</li>
<li>一致性(<code>Consistency</code>)：事务完成时，必须使所有数据都保持一致状态</li>
<li>隔离性(<code>Isolation</code>)：数据库系统提供的隔离机制，保证事务在不受外部并发操作影响的独立环境下运行</li>
<li>持久性(<code>Durability</code>)：事务一旦提交或回滚，它对数据库中的数据的改变就是永久的</li>
</ul>
<h2 id="4-并发事务问题"><a href="#4-并发事务问题" class="headerlink" title="4.并发事务问题"></a>4.并发事务问题</h2><table>
<thead>
<tr>
<th align="left">问题</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">脏读</td>
<td align="left">一个事务读到另一个事务还没提交的数据</td>
</tr>
<tr>
<td align="left">不可重复读</td>
<td align="left">一个事务先后读取同一条记录，但两次读取的数据不同</td>
</tr>
<tr>
<td align="left">幻读</td>
<td align="left">一个事务按照条件查询数据时，没有对应的数据行，但是再插入数据时，又发现这行数据已经存在</td>
</tr>
</tbody></table>
<ul>
<li><p>赃读（比如B读取到了A未提交的数据）</p>
<p><img src="https://image-bed-vz.oss-cn-hangzhou.aliyuncs.com/MySQL/image-20220605125309397.png" alt="image-20220605125309397"></p>
</li>
<li><p>不可重复读（事务A两次读取同一条记录，但是读取到的数据却是不一样的）</p>
<p><img src="https://image-bed-vz.oss-cn-hangzhou.aliyuncs.com/MySQL/image-20220605125417374.png" alt="image-20220605125417374"></p>
</li>
<li><p>幻读</p>
<p><img src="https://image-bed-vz.oss-cn-hangzhou.aliyuncs.com/MySQL/image-20220605125445124.png" alt="image-20220605125445124"></p>
</li>
</ul>
<h2 id="5-事务隔离级别"><a href="#5-事务隔离级别" class="headerlink" title="5.事务隔离级别"></a>5.事务隔离级别</h2><table>
<thead>
<tr>
<th align="left">隔离级别</th>
<th align="left">脏读</th>
<th align="left">不可重复读</th>
<th align="left">幻读</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Read uncommitted</td>
<td align="left">√</td>
<td align="left">√</td>
<td align="left">√</td>
</tr>
<tr>
<td align="left">Read committed</td>
<td align="left">×</td>
<td align="left">√</td>
<td align="left">√</td>
</tr>
<tr>
<td align="left"><strong>Repeatable Read(默认)</strong></td>
<td align="left">×</td>
<td align="left">×</td>
<td align="left">√</td>
</tr>
<tr>
<td align="left">Serializable</td>
<td align="left">×</td>
<td align="left">×</td>
<td align="left">×</td>
</tr>
</tbody></table>
<ul>
<li><p>√表示在当前隔离级别下该问题会出现</p>
</li>
<li><p><code>Serializable </code>性能最低；<code>Read uncommitted</code> 性能最高，数据安全性最差</p>
</li>
<li><p>查看事务隔离级别：<code>SELECT @@TRANSACTION_ISOLATION;</code></p>
</li>
<li><p>设置事务隔离级别：</p>
<pre class="line-numbers language-none"><code class="language-none">SET [ SESSION | GLOBAL ] TRANSACTION ISOLATION LEVEL {READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE };
sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><code>SESSION </code>是会话级别，表示只针对当前会话有效，<code>GLOBAL </code>表示对所有会话有效</p>
<p><strong>文章链接：</strong><a target="_blank" rel="noopener" href="https://www.oz6.cn/articles/67">https://www.oz6.cn/articles/67</a></p>
</li>
</ul>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">SuoLiweng</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://dick-su-3.github.io/archives/337fcc87.html">https://dick-su-3.github.io/archives/337fcc87.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">SuoLiweng</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/mysql/">
                                    <span class="chip bg-color">mysql</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/archives/afec5f7c.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/16.jpg" class="responsive-img" alt="Mybatis-plus笔记">
                        
                        <span class="card-title">Mybatis-plus笔记</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            一、MyBatis-Plus1.简介MyBatis-Plus (opens new window)（简称 MP）是一个 MyBatis (opens new window)的增强工具，在 MyBatis 的基础上只做增强不做改变，为简化开发
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2023-09-20
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/SSM%E6%A1%86%E6%9E%B6/" class="post-category">
                                    SSM框架
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/SSM/">
                        <span class="chip bg-color">SSM</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/archives/4f098c73.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/3.jpg" class="responsive-img" alt="黑天鹅效应、灰犀牛事件、明斯基时刻">
                        
                        <span class="card-title">黑天鹅效应、灰犀牛事件、明斯基时刻</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-09-20
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%9D%82%E8%AE%B0/" class="post-category">
                                    杂记
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E6%9D%82%E8%AE%B0/">
                        <span class="chip bg-color">杂记</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="26467411"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.5'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2022-2024</span>
            
            <a href="/about" target="_blank">SuoLiweng</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
                <span id="translate">|&nbsp;繁/简：</span><a id="translateLink" href="javascript:translatePage();">繁</a>
            
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/Jacksu3" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1530265947@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1530265947" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1530265947" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
        <script type="text/javascript" src="/js/tw_cn.js"></script>
        <script type="text/javascript">
          var defaultEncoding = 2; //网站编写字体是否繁体，1-繁体，2-简体
          var translateDelay = 0; //延迟时间,若不在前, 要设定延迟翻译时间, 如100表示100ms,默认为0
          var cookieDomain = "https://dick-su-3.github.io"; //Cookie地址, 一定要设定, 通常为你的网址
          var msgToTraditionalChinese = "繁"; //此处可以更改为你想要显示的文字
          var msgToSimplifiedChinese = "简"; //同上，但两处均不建议更改
          var translateButtonId = "translateLink"; //默认互换id
          translateInitilization();
        </script>
    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>
